\input{../EncabezadoTesis}
\begin{document}

\justifying
\chapter{Modelando la Población del Vector de Dengue Utilizando Datos de Sensado Remoto y Aprendizaje Automático}

  \par Como mencionamos en capitulos anteriores, en un trabajo interinstitutional entre
    la Comisión Nacional de Actividades Espaciales (CONAE) y el ministerio de salud
    de Argentina, hubo iniciativas orientadas a modelar la evolución temporal de
    las poblaciones de mosquitos usando variables ambientales obtenidas de
    sensores remotos. Estos trabajos utilizaron series de algunos años y fueron
    basadas en un pequeño número de variables satelitales \cite{ndwi_erffectiveness, modis_data}.
    En un esfuerzo para mejorar esto, \cite{temporal_modeling}, construyeron modelos
    basados en una gran cantidad de variables de varios sensores de cuatro años.
    Aún así, todos estos trabajos asumieron modelos lineales multivariados.

  \par Este trabajo representa una mejoría sobre dicho escenario. Comparamos
    Support Vector Machines (SVM), Redes Neuronales Artificiales (ANN),
    K-vecinos más cercanos (KNN) y un tipo de árbol de decisión orientado a
    regresión, sumados a dos modelos de regresión lineal. Con ésto, se
    obtiene una metodología operaciónes que contribuye al sistema de riesgo
    de Dengue actualmente en operación \cite{porcasi_operative, analisis_cordoba}.

  \par Se explora, encontraste con los trabajos previos mencionados, la habilidad
    de modelado y predicción de oviposición con algoritmos de Aprendizaje
    Automático \textit{off-the-shelf}, i.e. algoritmos de software libre, ya
    implementados, sin mayores desarrollos sobre lo existente y con un ajuste de
    hyperparámetros minimo. De ésta manera se busca la asimilación de estas
    técnicas a toda la comunidad que se ocupa de problemas similares.


\section{Materiales}

\subsection{Datos de estudio y Datos de Campo}
  \begin{figure}
  \centering%
  \includegraphics[width=0.6\textwidth]{images/tartagal}%
  \caption{Área de Estudio}\label{fig:tartagal}
  \end{figure}

  \par El estudio presentado fue desarrollado en la ciudad de Tartagal
    (con 79900 habitantes) en el noroeste de Argentina
    (\ang{22;32;}~S, \ang{63;49;}~O, \SI{450}{\meter} sobre el nivel del mar),
    en la provincia de Salta. El sitio está entre 50 y 100 kms de la frontera
    entre Argentina y Bolivia, como se puede apreciar en la Figura \ref{fig:tartagal}

  \par Este lugar tiene una temperatura media anual de unos \SI{23}{\degreeCelsius}
    (máximo promedio de verano de \SI{39}{\degreeCelsius} y minimo promedio en
    invieron de \SI{9}{\degreeCelsius}). Tiene una precipitación anual de
    \SI{1100}{\milli\meter}, con una estación seca (Junio a Octubre).
    Tartagal, como muchas ciudades del noroeste argentino, tiene una diversidad
    cultural basada en la presencia de grupos étnicos autóctonos y población
    de inmigrantes sumada al movimiento de migración proveniente de Bolivia.
    Estas características conducen a un perfil peculiar de comportamiento
    cultural, social y economico.

  \par La población de vectores es medida monitoreando la actividad de oviposición.
    Es medida usando ovitrampas colocadas en casas aleatoriamente seleccionadas
    en el área urbana de la ciudad. El período de monitoreo utilizado en este
    estudio fue de Agosto de 2012 hasta Julio de 2016 sobre 50 cassas. Dos
    ovitrampas fueron colocadas en cada una: una dentro y otra fuera de la casa,
    en el patio trasero en un lugar con sombra y a nivel del suelo, siguiendo
    las instrucciones de la OMS \cite{peridomestic}. Las ovitrampas son contenedores
    de \SI{1000}{\centi\meter\cubed} de plástico negro con \SI{250}{\milli\liter}
    de agua sin ninguna infusión de atracción.
    En este estudio sólo utilizamos los datos de las ovitrampas externas dado
    que ellas tienen una mayor correlación con las variables ambientales
    derivadas de información satelital. Dichas ovitrampas son reempazadas
    semanalmente y los huevos son contados en un laboratorio de acuerdo al
    \textit{Indice de Densidad de Huevos} \cite{indice_huevos}. Luego, la
    actividad de oviposición del \textit{Aedes Aegipty} es estimada por la suma
    de los huevos capturados en las trampas externas de la ciudad.



\subsection{Variables Ambientales}

  \par Siguiendo la idea de construir modelos predicticos de la población de
    vectores basados en variables ambientales derivadas de satelites, pero con una
    perspectiva operacional basada en trabajos previos, se obtuvieron representaciones
    de vegetación, humedad, temperatura y lluvia operacionalmente disponibles
    de \textbf{MODIS} y productos \textbf{TRMM/GPM}.

  \par Los índices de vegetación global proveen productos espaciales y
    temporales consistentes sobre la cobertura verdosa de la vegetación,
    propiedades del área foliar y el nivel de clorofil. Estos indices son
    derivados de la reflectancia atmosférica
    corregida en las bandas infrarroja (MIR) e infrarroja cercana (NIR).
    En este caso se utiliza el \textbf{NDVI} de producto satelital
    de MODIS, \textit{MOD13Q1}, (compuesto de 16 días) con una resolución espacial de
    \SI{250}{\meter}.
    Las condiciones de vegetación son incluidas junto con la temperatura,
    humedad y precipitación, son variables relevantes para la evolución de la
    población de mosquitos \cite{ndwi_erffectiveness, rs_invertebrate}.

  \par A su vez, se incluyé el Indice de Agua de Diferencia Normalizada
    (\textbf{NDWI}), que está vinculado al contenido de agua líquida y humedad
    tanto en la vegetación como en estructuras sólidas.
    Es calculada a partir del mismo producto MODIS usando la definición de
    \textit{Gao} \cite{gao_ndwi} del NDWI desde las bandas provistas por
    el producto \textit{MOD13Q1}, correspondiente a la reflectancia de MIR y NIR:
    $NDWI =  (\rho_{NIR} - \rho_{MIR}) / (\rho_{NIR}  + \rho_{MIR} ) \times 10^4$
    Los productos MODIS, en general, necesitan el factor $10^{4}$ para ser guardados,
    por eficiencia computacional, como números enteros.

  \par En este trabajo, adicionalmente, utilizamos la Temperatura De la Superficie
    Terrestre (\textbf{LST}) de MODIS dado que es una aproximación de la
    temperatura ambiental \cite{infectious_diseases, surface_temp, temp_algorithm}.
    Para esto, se eligió el producto satelital \textit{MOD11A2}. Tiene una
    resolución espacial de \SI{1}{\kilo\meter} y un promedio de valores de
    LST de cielo-abierto durante un periodo de 8 días. Éste producto incluye
    LST de la noche y el día para así de alguna manera representar
    temperaturas mínimas y máximas \cite{lst_surface}.

  \par La precipitación local es obtenida de la Misión Tropical de Medida de Lluvia
    (\textbf{TRMM}) \cite{trmm_mision}. Ésta es una misión conjunta entre la
    NASA y la Agencia Aeroespacial de Exploración de Japón lanzada en 1997
    para el estudio de las lluvias y así realizar investigaciones sobre el
    clima. Para detectar la lluvia, el satélite utiliza muchos instrumentos
    incluyendo radar, imagenes de microondas y sensores de rayos. TRMM, a pesar
    de que se quedó sin combustible en 2014, siguió transmitiendo datos hasta
    Junio del 2015.
    Luego de eso, otros productos basados en una nueva misión espacial llamada
    GPM (\url{https://earthdata.nasa.gov/trmm-to-gpm}), fueron publicados para
    asegurar la continuidad de estos trabajos.


  \par Dos áreas de \SI{85}{\hectare} fueron definidas alrededor de la ciudad
    y se calcularon los valores medios para todas las variables derivadas de
    satelite. Siguiendo el enfoque de
    \cite{models_predicting, dynamics_of_dengue, temporal_modeling},
    la primer área se encuentra ubicada dentro de la ciudad
    (Área Urbana) y la segunda abarca la vegetacion nativa que rodea la ciudad
    (Área Rural). Ésta elección fue tomada bajo la hipótesis de que seleccionar
    una zona fuera de la ciudad representaría bien las condiciones ambientales
    (NDWI, NDVI, LST). La misma idea fue utilizada en estudios previos muy
    relacionados. Es probable que estas observaciones y los indices de larvas
    estén estrechamente relacionadas. En ese sentido es que el área rural o
    externe fue seleccionada aleatoriamente de aquellas con vegetación suficientemente
    cercana a la ciudad, representando condiciones ambientales naturales.
    En este caso específico esta región rural es seleccionada en el
    noreste de la ciudad; tiene una altitud similar a la ciudad y mayormente
    bosque nativo. Se puede observar en la Figura \ref{fig:zones}.
    \begin{figure}
    \centering%
    \includegraphics[width=0.6\textwidth]{images/zones}%
    \caption{Areas rural y urbana seleccionadas para extraer las variables ambientales}\label{fig:zones}
    \end{figure}


  \par El procedimiento de construir las series temporales a partir de variables
    provenientes del sensado remoto se describen en la Figura \ref{fig:sistema}.
    Las imagenes son obtenidas de la NASA (\url{http://e4ftl01.cr.usgs.gov}) e
    importadas en \textbf{GRASS 7.1}. Para cada una de las áreas anteriormente
    definidas se calcula la media de cada día. Cada uno de estos valores
    promedio y sos díás son exportadas a una tabla en el software \textbf{R},
    donde es utilizada para construir las series temporales completas.
    Los datos son interpolados para obtener valores para cada uno de los
    días de muestra (un valor para cada semana epidemiológica).
    \begin{figure}
    \centering%
    \includegraphics[width=0.4\textwidth]{images/sistema}%
    \caption{Sistema de procesamiento de productos satelitales}\label{fig:sistema}
    \end{figure}

  \par Todas las variables son consideradas con tres semanas de \textit{lag}
  teniendo en cuenta las series temporales originales, para representar las
  influencias asincrónicas, correspondientemente con uno, dos o tres
  lapsos de tiempo.

  \par El primer paso consistió en analizar las cuarenta variables ambientales
    y los huevos recolectados cada semana por medio de una matriz de correlación
    y los valores \textbf{p} que miden su significancia. Ésto llevó a descartar
    treinta y cinco variables. Se prefieren las variables con \textit{lag} dada
    su potencial habilidad de pronóstico. Las siguiente variables fueron
    seleccionadas: NDVI rural \textit{lag} 1, NDWI rural \textit{lag} 1, LST rural dia \textit{lag} 3,
    LST rural noche \textit{lag} 1 y TRMM \textit{lag} 3. Luego, todas las
    variables fueron normalizadas utilizando el \textbf{\textit{z-score}}.

  \par La Figura \ref{fig:heatmap} presenta las variables ambientales junto
    con la oviposición en un mapa de calor (\textit{heatmap}). Este formato
    permite una visualización en la evolución temporal, de los
    patrones de correlación entre las variables y el efecto de \textit{lag}.

    \begin{figure}
    \centering%
    \includegraphics[width=1\textwidth]{images/heatmap}%
    \caption{Sistema de procesamiento de productos satelitales}\label{fig:heatmap}
    \end{figure}



\section{Modelado}

  \par Con el conjunto de datos descripto en la sección anterior, se implementaron
    dos modelos lineales (tradicional y \textit{Ridge}) y cuatro modelos
    no-lineales (\textit{Support Vector Machine}, ANN Perceptron Multicapa,
    Árbol de Decisión, K-vecinos más cercanos) para modelar la oviposición
    para cada semana. Para todos los modelos se utilizó el mismo conjunto de
    5 variables ambientales como \textit{features}.

  \par En todos los casos se entrenaron los modelos con 80\% del conjunto de
    datos y se utilizó el 20\% restante de la serie temporal (alrededor de un año)
    como un conjunto independiente para validar la capacidad de predicción temporal
    de las herramientas (se usó el 20\% más "nuevo" del conjunto). Ésta elección
    de porcentajes de división es la más utilizada en la literatura de ML \cite{ml_rainfall}.

  \par Se utilizó \textbf{Validación Cruzada}
    (\textit{Cross Validation}) \cite{cross_validation, ml_rainfall} con el
    objetivo de reducir la dependencia de los resultados en una selección particular
    del par de conjuntos de entrenamiento y validación. En particular, para
    evaluar los modelos, se utilizó un procedimiento de validación cruzada
    particular para problemas que involucran series temporales
    \url{http://scikit-learn.org/stable/modules/cross_validation.html}.
    Otras técnicas de validación cruzada como \textit{K-folds} no son
    adecuadas para los datos que se corresponden con series temporales, i.e,
    cuando el orden en el conjunto de datos es importante.

    \par A continuación se describiran las técnicas utilizadas para modelar
    el \textit{z-score} de la oviposición como una función variables ambientales
    extraidas de sensores remotos. Todos los modelos fueron implementados utilizando
    funciones de la librería \textbf{\textit{scikit-learn}}, disponible
    gratuitamente para el lenguaje \textbf{Python}.



\begin{center}
\begin{threeparttable}
\centering%
\caption{Participaci\'{o}n de las energ\'{\i}as renovables en el suministro
total de energ\'{\i}a primaria \cite{AG02i}.}\label{EMundo1}
\begin{tabular}{|l|c|c|}\hline
&\multicolumn{2}{c|}{Participaci\'{o}n en el suministro de energ\'{\i}a primaria /\% (Mtoe)\;$\tnote{1}$}\\\cline{2-3}%
\arr{Region}&Energ\'{\i}as renovables &Participaci\'{o}n de la biomasa\\\hline%
Latinoam\'{e}rica&28,9 (140)&62,4 (87,4)\\\hline%
\:Colombia&27,7 (7,6)&54,4 (4,1)\\\hline%
Alemania&3,8 (13,2)&65,8 (8,7)\\\hline%
Mundial&13,1 (1404,0)&79,4 (1114,8)\\\hline
\end{tabular}
\begin{tablenotes}
\item[1] \footnotesize{1 kg oe=10000 kcal=41,868 MJ}
\end{tablenotes}
\end{threeparttable}
\end{center}

\end{document}
